# Spaced Repetition AI

<div align="center">

![Java](https://img.shields.io/badge/Java-17-orange?style=for-the-badge&logo=java)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.3-brightgreen?style=for-the-badge&logo=spring)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue?style=for-the-badge&logo=postgresql)
![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)

**Sistema inteligente de aprendizado por repeti√ß√£o espa√ßada com gera√ß√£o de conte√∫do multimodal powered by AI**

[Caracter√≠sticas](#-caracter√≠sticas-principais) ‚Ä¢ [Tecnologias](#-stack-tecnol√≥gico) ‚Ä¢ [Instala√ß√£o](#-instala√ß√£o-e-configura√ß√£o) ‚Ä¢ [API](#-documenta√ß√£o-da-api) ‚Ä¢ [Arquitetura](#-arquitetura-do-projeto)

</div>

---

## üìñ Vis√£o Geral

**Spaced Repetition AI** √© uma plataforma backend robusta e escal√°vel que revoluciona o aprendizado atrav√©s da t√©cnica de repeti√ß√£o espa√ßada combinada com intelig√™ncia artificial. O sistema utiliza a API do **Google Gemini** para gerar automaticamente flashcards multimodais (texto, imagem e √°udio) a partir de simples prompts, eliminando a necessidade de cria√ß√£o manual de conte√∫do educacional.

### üéØ Problema Resolvido

Criar flashcards de qualidade √© um processo manual, demorado e repetitivo. Este projeto automatiza completamente essa tarefa, permitindo que estudantes foquem no que realmente importa: o aprendizado.

### üí° Solu√ß√£o

- ‚úÖ Gera√ß√£o autom√°tica de conte√∫do educacional com IA
- ‚úÖ Suporte multimodal: texto, imagens e pron√∫ncia em √°udio
- ‚úÖ Algoritmo de repeti√ß√£o espa√ßada otimizado
- ‚úÖ Sistema de cr√©ditos e monetiza√ß√£o integrado
- ‚úÖ Armazenamento em cloud com AWS S3 e CloudFront
- ‚úÖ Autentica√ß√£o social (Google, GitHub) e local

---

## ‚ú® Caracter√≠sticas Principais

### üîê Autentica√ß√£o e Autoriza√ß√£o
- **Autentica√ß√£o JWT** com tokens seguros de 256 bits
- **OAuth 2.0** integrado (Google e GitHub)
- Verifica√ß√£o de email com tokens tempor√°rios
- Sistema de roles e permiss√µes

### üìö Gerenciamento de Decks
- CRUD completo de decks de estudo
- Configura√ß√£o personalizada por deck:
  - Idiomas de origem e destino
  - Estilos de imagem (Anime, Fotorrealismo, Cartoon, Filme)
  - Gera√ß√£o de imagem/√°udio habilitada/desabilitada
  - Tipo de deck (Idioma, Geral)
- Estat√≠sticas de performance (taxa de acerto, progresso)

### üÉè Flashcards Inteligentes
- **Gera√ß√£o manual**: cria√ß√£o tradicional com front/back
- **Gera√ß√£o com IA**: cria√ß√£o autom√°tica completa
  - Texto otimizado para memoriza√ß√£o
  - Imagens mnem√¥nicas contextualizadas
  - √Åudio com pron√∫ncia nativa (TTS)
- Templates de prompt especializados:
  - Idiomas estrangeiros
  - Flashcards m√∫ltiplos em lote
  - Conceitos gerais educacionais

### üß† Sistema de Repeti√ß√£o Espa√ßada
- Algoritmo baseado no m√©todo SM-2 (SuperMemo)
- Ajuste din√¢mico do **ease factor**
- 4 n√≠veis de avalia√ß√£o: ERRADO, DIF√çCIL, BOM, F√ÅCIL
- C√°lculo inteligente da pr√≥xima revis√£o
- Tracking de performance por deck e card

### üí∞ Sistema de Monetiza√ß√£o
- Integra√ß√£o completa com **Mercado Pago**
- Sistema de cr√©ditos (balance)
- 3 pacotes de cr√©ditos pr√©-configurados:
  - 300 cr√©ditos: R$ 40,00
  - 600 cr√©ditos: R$ 70,00
  - 1000 cr√©ditos: R$ 100,00
- Webhooks para processamento autom√°tico de pagamentos
- Consumo de cr√©ditos:
  - Gera√ß√£o de imagem: 5 cr√©ditos
  - Gera√ß√£o de √°udio: 1 cr√©dito

### ‚òÅÔ∏è Infraestrutura Cloud
- **AWS S3**: armazenamento escal√°vel de m√≠dia
- **CloudFront**: CDN global com signed cookies
- Upload via presigned URLs
- Convers√£o autom√°tica de √°udio para WAV

### üîÑ Processamento Ass√≠ncrono
- Gera√ß√£o de conte√∫do IA em background
- Retry autom√°tico com backoff exponencial
- Thread pool configur√°vel
- Envio de emails ass√≠ncrono

---

## üöÄ Stack Tecnol√≥gico

### Backend Core
- **Java 17** - Linguagem principal
- **Spring Boot 3.5.3** - Framework enterprise
  - Spring Web (REST APIs)
  - Spring Security (Autentica√ß√£o/Autoriza√ß√£o)
  - Spring Data JPA (ORM)
  - Spring OAuth2 Client
  - Spring Mail (Email SMTP)
  - Spring Retry (Resil√™ncia)

### Banco de Dados
- **PostgreSQL** - Banco relacional principal
- **H2** - Banco em mem√≥ria para testes

### Intelig√™ncia Artificial
- **Google Gemini API**
  - Modelo: `gemini-2.5-flash` (texto)
  - Modelo: `imagen-4.0-fast-generate-001` (imagem)
  - Modelo: `gemini-2.5-flash-preview-tts` (√°udio)

### Seguran√ßa
- **JWT (jjwt 0.12.5)** - Autentica√ß√£o stateless
- **BCrypt** - Hash de senhas
- **OAuth 2.0** - Login social

### Pagamentos
- **Mercado Pago SDK** - Gateway de pagamento brasileiro

### Cloud & Storage
- **AWS SDK for Java**
  - S3 Client (armazenamento)
  - CloudFront (distribui√ß√£o)

### Build & DevOps
- **Maven** - Gerenciamento de depend√™ncias
- **Docker** - Containeriza√ß√£o
- **Docker Compose** - Orquestra√ß√£o local

### Testes
- **JUnit 5** - Framework de testes
- **Mockito 5.18** - Mocking
- **Spring Boot Test** - Testes de integra√ß√£o

### Outras Bibliotecas
- **Lombok** - Redu√ß√£o de boilerplate
- **Jackson** - Serializa√ß√£o JSON
- **Jakarta Validation** - Valida√ß√£o de dados
- **SLF4J + Logback** - Logging

---

## üìã Pr√©-requisitos

Antes de come√ßar, certifique-se de ter instalado:

- ‚òï **Java JDK 17** ou superior ([Download](https://adoptium.net/))
- üì¶ **Maven 3.8+** ([Download](https://maven.apache.org/download.cgi))
- üêò **PostgreSQL 15+** ([Download](https://www.postgresql.org/download/))
- üê≥ **Docker** e **Docker Compose** (opcional, para deployment)
- üîë **Conta Google Cloud** (para Gemini API)
- üí≥ **Conta Mercado Pago** (para gateway de pagamento)
- ‚òÅÔ∏è **Conta AWS** (para S3 e CloudFront)

---

## üõ†Ô∏è Instala√ß√£o e Configura√ß√£o

### 1. Clone o Reposit√≥rio

```bash
git clone https://github.com/IgorLana/Spaced-Repetition-AI.git
cd Spaced-Repetition-AI
```

### 2. Configure o Banco de Dados PostgreSQL

Crie um banco de dados para a aplica√ß√£o:

```sql
CREATE DATABASE spaced_repetition_db;
CREATE USER spaced_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE spaced_repetition_db TO spaced_user;
```

### 3. Configure as Vari√°veis de Ambiente

Crie ou edite o arquivo `src/main/resources/application.properties`:

```properties
# ===================================================================
# CONFIGURA√á√ïES DO BANCO DE DADOS
# ===================================================================
spring.datasource.url=jdbc:postgresql://localhost:5432/spaced_repetition_db
spring.datasource.username=spaced_user
spring.datasource.password=your_secure_password
spring.datasource.driver-class-name=org.postgresql.Driver

# ===================================================================
# CONFIGURA√á√ïES DO JPA/HIBERNATE
# ===================================================================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# ===================================================================
# CONFIGURA√á√ïES DO SERVIDOR
# ===================================================================
server.port=9090

# ===================================================================
# CONFIGURA√á√ïES DE SEGURAN√áA (JWT)
# ===================================================================
# IMPORTANTE: Gere uma chave segura de 256+ bits
jwt.secret-key=YOUR_SUPER_SECRET_JWT_KEY_WITH_AT_LEAST_256_BITS_CHANGE_THIS

# ===================================================================
# GOOGLE GEMINI API
# ===================================================================
gemini.api.key=YOUR_GEMINI_API_KEY_HERE

# ===================================================================
# MERCADO PAGO
# ===================================================================
api.v1.mercadopago-access-token=YOUR_MERCADOPAGO_ACCESS_TOKEN

# ===================================================================
# AWS S3 E CLOUDFRONT
# ===================================================================
aws.s3.bucket-name=your-s3-bucket-name
aws.s3.region=sa-east-1
aws.access-key=YOUR_AWS_ACCESS_KEY
aws.secret-key=YOUR_AWS_SECRET_KEY
cloudfront.domain-name=your-cloudfront-distribution.cloudfront.net
cloudfront.key-pair-id=YOUR_CLOUDFRONT_KEY_PAIR_ID
cloudfront.private-key-path=/path/to/cloudfront_private_key.pem

# ===================================================================
# OAUTH2 (GOOGLE E GITHUB)
# ===================================================================
spring.security.oauth2.client.registration.google.client-id=YOUR_GOOGLE_CLIENT_ID
spring.security.oauth2.client.registration.google.client-secret=YOUR_GOOGLE_CLIENT_SECRET
app.oauth2.redirect-uri=http://localhost:4200/auth/callback

spring.security.oauth2.client.registration.github.client-id=YOUR_GITHUB_CLIENT_ID
spring.security.oauth2.client.registration.github.client-secret=YOUR_GITHUB_CLIENT_SECRET
spring.security.oauth2.client.registration.github.scope=read:user,user:email

# ===================================================================
# CONFIGURA√á√ïES DE EMAIL (SMTP)
# ===================================================================
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=your-email@gmail.com
spring.mail.password=your-app-specific-password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# ===================================================================
# OUTRAS CONFIGURA√á√ïES
# ===================================================================
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB
spring.jackson.time-zone=UTC
cookie-domain=localhost
logging.level.com.spaced_repetition_ai.service=INFO
```

### 4. Obtenha as Credenciais Necess√°rias

#### Google Gemini API
1. Acesse [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Crie um projeto e gere uma API Key
3. Copie a key para `gemini.api.key`

#### Mercado Pago
1. Acesse o [Mercado Pago Developers](https://www.mercadopago.com.br/developers)
2. Crie uma aplica√ß√£o
3. Copie o **Access Token** (teste ou produ√ß√£o)
4. Configure o webhook URL: `https://your-domain.com/api/v1/webhooks/mercadopago`

#### AWS S3 e CloudFront
1. Crie um bucket S3
2. Configure uma distribui√ß√£o CloudFront
3. Gere um Key Pair para signed URLs
4. Configure as credenciais IAM

#### OAuth2 (Google e GitHub)
- **Google**: [Console Cloud](https://console.cloud.google.com/apis/credentials)
- **GitHub**: [Developer Settings](https://github.com/settings/developers)

### 5. Compile e Execute a Aplica√ß√£o

#### Usando Maven

```bash
# Compile o projeto
mvn clean install

# Execute a aplica√ß√£o
mvn spring-boot:run
```

#### Usando Docker

```bash
# Build da imagem
docker build -t spaced-repetition-ai .

# Execute o container
docker-compose up -d
```

### 6. Verifique a Aplica√ß√£o

A API estar√° dispon√≠vel em: **http://localhost:9090**

Teste o health check:
```bash
curl http://localhost:9090/api/auth/login
```

---

## üì° Documenta√ß√£o da API

Todos os endpoints (exceto `/api/auth/*`) requerem autentica√ß√£o JWT via header:

```
Authorization: Bearer <seu-token-jwt>
```

### üîê Autentica√ß√£o (`/api/auth`)

#### **POST** `/api/auth/register`
Registra um novo usu√°rio no sistema.

**Request Body:**
```json
{
  "name": "Jo√£o Silva",
  "email": "joao.silva@example.com",
  "password": "SenhaForte123!"
}
```

**Response:** `200 OK`
```json
{
  "message": "Registro bem-sucedido. Por favor, verifique seu e-mail para ativar a conta.",
  "token": null
}
```

#### **POST** `/api/auth/login`
Autentica um usu√°rio e retorna um token JWT.

**Request Body:**
```json
{
  "email": "joao.silva@example.com",
  "password": "SenhaForte123!"
}
```

**Response:** `200 OK`
```json
{
  "message": "Login realizado com sucesso",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### **GET** `/api/auth/verify`
Verifica o email do usu√°rio via token.

**Query Params:**
- `token`: Token de verifica√ß√£o enviado por email

**Response:** `200 OK`

---

### üìö Decks (`/api/deck`)

#### **GET** `/api/deck`
Lista todos os decks do usu√°rio autenticado.

**Response:** `200 OK`
```json
[
  {
    "id": 1,
    "name": "Vocabul√°rio de Ingl√™s",
    "description": "Palavras essenciais para iniciantes",
    "targetLanguage": "INGLES_EUA",
    "sourceLanguage": "PORTUGUES_BRASIL",
    "easeFactor": 2.5,
    "generateImage": true,
    "generateAudio": true,
    "deckType": "LANGUAGE",
    "imageStyle": "ANIME_STYLE"
  }
]
```

#### **GET** `/api/deck/{deckId}/info`
Retorna informa√ß√µes detalhadas de um deck espec√≠fico.

**Response:** `200 OK`
```json
{
  "id": 1,
  "name": "Vocabul√°rio de Ingl√™s",
  "description": "Palavras essenciais",
  "targetLanguage": "INGLES_EUA",
  "sourceLanguage": "PORTUGUES_BRASIL",
  "easeFactor": 2.5,
  "generateImage": true,
  "generateAudio": true,
  "deckType": "LANGUAGE",
  "flashcardsToReview": 12,
  "totalFlashcards": 50,
  "averageScore": 0.85
}
```

#### **POST** `/api/deck`
Cria um novo deck.

**Request Body:**
```json
{
  "name": "Espanhol B√°sico",
  "description": "Primeiras 500 palavras",
  "targetLanguage": "ESPANHOL_EUA",
  "sourceLanguage": "PORTUGUES_BRASIL",
  "generateImage": true,
  "generateAudio": true,
  "deckType": "LANGUAGE",
  "imageStyle": "PHOTOREALISM",
  "easeFactor": 2.0
}
```

**Response:** `201 Created`

#### **PUT** `/api/deck/{id}`
Atualiza um deck existente.

**Request Body:**
```json
{
  "name": "Novo Nome",
  "description": "Nova descri√ß√£o",
  "targetLanguage": "INGLES_EUA",
  "sourceLanguage": "PORTUGUES_BRASIL",
  "easeFactor": 2.2
}
```

**Response:** `200 OK`

#### **DELETE** `/api/deck/{deckId}`
Remove um deck e todos os seus flashcards.

**Response:** `204 No Content`

---

### üÉè Flashcards (`/api/flashcard`)

#### **GET** `/api/flashcard`
Lista todos os flashcards de um deck.

**Query Params:**
- `deckId`: ID do deck

**Response:** `200 OK`
```json
[
  {
    "id": 1,
    "front": "Cat",
    "back": "Gato",
    "imagePath": "https://cdn.example.com/images/cat.png",
    "audioPath": "https://cdn.example.com/audio/cat.wav",
    "createdDate": "2025-10-01T10:00:00",
    "lastReview": "2025-10-04T15:30:00",
    "nextReview": "2025-10-07T15:30:00",
    "interval": 3,
    "easeFactor": 2.5,
    "rating": "BOM"
  }
]
```

#### **POST** `/api/flashcard`
Cria um flashcard manualmente.

**Query Params:**
- `deckId`: ID do deck

**Request Body:**
```json
{
  "front": "Hello",
  "back": "Ol√°",
  "imagePath": null,
  "audioPath": null
}
```

**Response:** `201 Created`

#### **POST** `/api/flashcard/ai`
Gera um flashcard completo usando IA (texto + imagem + √°udio).

**Query Params:**
- `deckId`: ID do deck
- `prompt`: Palavra ou conceito (ex: "dog", "photosynthesis")

**Response:** `200 OK`
```json
{
  "id": 15,
  "front": "Dog",
  "back": "Cachorro\n\nExample: The dog is playing in the park.",
  "imagePath": "https://cdn.example.com/images/dog-abc123.png",
  "audioPath": "https://cdn.example.com/audio/dog-abc123.wav",
  "createdDate": "2025-10-05T10:00:00",
  "nextReview": "2025-10-05T10:01:00",
  "interval": 1,
  "easeFactor": 2.5,
  "rating": "BOM"
}
```

**Custos:**
- Gera√ß√£o de imagem: 5 cr√©ditos
- Gera√ß√£o de √°udio: 1 cr√©dito
- **Total**: 6 cr√©ditos por flashcard completo

#### **PUT** `/api/flashcard/{id}`
Atualiza um flashcard existente.

**Request Body:**
```json
{
  "front": "Cat (updated)",
  "back": "Gato (atualizado)",
  "imagePath": "https://...",
  "audioPath": "https://..."
}
```

**Response:** `200 OK`

#### **DELETE** `/api/flashcard/{flashCardId}`
Remove um flashcard.

**Response:** `204 No Content`

---

### üß† Revis√£o (`/api/review`)

#### **GET** `/api/review`
Retorna os flashcards prontos para revis√£o em um deck.

**Query Params:**
- `id`: ID do deck

**Response:** `200 OK`
```json
[
  {
    "id": 5,
    "front": "Apple",
    "back": "Ma√ß√£",
    "nextReview": "2025-10-05T09:00:00"
  },
  {
    "id": 12,
    "front": "Tree",
    "back": "√Årvore",
    "nextReview": "2025-10-05T08:30:00"
  }
]
```

Se n√£o houver cards para revisar: `204 No Content`

#### **POST** `/api/review`
Registra uma revis√£o e atualiza o algoritmo de repeti√ß√£o espa√ßada.

**Query Params:**
- `id`: ID do flashcard
- `review`: Avalia√ß√£o (`ERRADO`, `DIFICIL`, `BOM`, `FACIL`)

**L√≥gica do Algoritmo:**
- **ERRADO**: `interval = 1 dia`, `easeFactor -= 0.20`
- **DIFICIL**: `interval *= (easeFactor - 0.15)`
- **BOM**: `interval *= easeFactor`
- **FACIL**: `interval *= (easeFactor + 0.15)`

**Response:** `200 OK`

---

### üí≥ Pagamentos (`/api/v1/payment`)

#### **POST** `/api/v1/payment/preference`
Cria uma prefer√™ncia de pagamento no Mercado Pago.

**Request Body:**
```json
{
  "packageId": "package_600"
}
```

**Pacotes Dispon√≠veis:**
- `package_300`: 300 cr√©ditos por R$ 40,00
- `package_600`: 600 cr√©ditos por R$ 70,00
- `package_1000`: 1000 cr√©ditos por R$ 100,00

**Response:** `200 OK`
```json
{
  "preferenceId": "123456789-abcd-1234-5678-abc123def456",
  "initPoint": "https://www.mercadopago.com.br/checkout/v1/redirect?pref_id=..."
}
```

#### **POST** `/api/v1/webhooks/mercadopago`
Webhook para processar notifica√ß√µes de pagamento (uso interno).

---

### üë§ Usu√°rio (`/api/user`)

#### **GET** `/api/user/me`
Retorna as informa√ß√µes do usu√°rio autenticado.

**Response:** `200 OK`
```json
{
  "id": 1,
  "name": "Jo√£o Silva",
  "email": "joao.silva@example.com",
  "balance": 150,
  "role": "USER",
  "isVerified": true,
  "authProvider": "LOCAL"
}
```

---

## üèóÔ∏è Arquitetura do Projeto

O projeto segue uma arquitetura em camadas (Layered Architecture) com separa√ß√£o clara de responsabilidades:

```
src/main/java/com/spaced_repetition_ai/
‚îÇ
‚îú‚îÄ‚îÄ config/                          # Configura√ß√µes do Spring
‚îÇ   ‚îú‚îÄ‚îÄ ApplicationConfig.java       # Beans de autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ AsyncConfig.java             # Configura√ß√£o de threads ass√≠ncronas
‚îÇ   ‚îú‚îÄ‚îÄ AWSConfig.java               # Beans AWS S3 e CloudFront
‚îÇ   ‚îú‚îÄ‚îÄ JwtAuthFilter.java           # Filtro JWT
‚îÇ   ‚îú‚îÄ‚îÄ OAuth2AuthenticationSuccessHandler.java
‚îÇ   ‚îú‚îÄ‚îÄ SecurityConfig.java          # Configura√ß√£o Spring Security
‚îÇ   ‚îî‚îÄ‚îÄ StaticResourceConfig.java    # Servir arquivos est√°ticos
‚îÇ
‚îú‚îÄ‚îÄ controller/                      # Camada de Apresenta√ß√£o (REST)
‚îÇ   ‚îú‚îÄ‚îÄ AudioGenerationController.java
‚îÇ   ‚îú‚îÄ‚îÄ AuthController.java
‚îÇ   ‚îú‚îÄ‚îÄ DeckController.java
‚îÇ   ‚îú‚îÄ‚îÄ FlashCardController.java
‚îÇ   ‚îú‚îÄ‚îÄ ImageGenerationController.java
‚îÇ   ‚îú‚îÄ‚îÄ ReviewController.java
‚îÇ   ‚îú‚îÄ‚îÄ TextGenerationController.java
‚îÇ   ‚îî‚îÄ‚îÄ UserController.java
‚îÇ
‚îú‚îÄ‚îÄ dto/                             # Data Transfer Objects
‚îÇ   ‚îú‚îÄ‚îÄ AuthRequestDTO.java
‚îÇ   ‚îú‚îÄ‚îÄ AuthResponse.java
‚îÇ   ‚îú‚îÄ‚îÄ DeckRequestDTO.java
‚îÇ   ‚îú‚îÄ‚îÄ DeckResponseDTO.java
‚îÇ   ‚îú‚îÄ‚îÄ FlashcardRequestDTO.java
‚îÇ   ‚îú‚îÄ‚îÄ FlashcardResponseDTO.java
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ entity/                          # Entidades JPA (Camada de Persist√™ncia)
‚îÇ   ‚îú‚îÄ‚îÄ DeckEntity.java              # Tabela: decks
‚îÇ   ‚îú‚îÄ‚îÄ FlashCardEntity.java         # Tabela: flashcards
‚îÇ   ‚îú‚îÄ‚îÄ ReviewEntity.java            # Tabela: reviews
‚îÇ   ‚îú‚îÄ‚îÄ UserEntity.java              # Tabela: users
‚îÇ   ‚îî‚îÄ‚îÄ StandardFlashCardEntity.java
‚îÇ
‚îú‚îÄ‚îÄ exception/                       # Tratamento de Exce√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ DatabaseException.java
‚îÇ   ‚îú‚îÄ‚îÄ ExternalServiceException.java
‚îÇ   ‚îú‚îÄ‚îÄ GlobalExceptionHandler.java  # @RestControllerAdvice
‚îÇ   ‚îî‚îÄ‚îÄ NotFoundException.java
‚îÇ
‚îú‚îÄ‚îÄ model/                           # Enums e Modelos de Dom√≠nio
‚îÇ   ‚îú‚îÄ‚îÄ AuthProvider.java            # LOCAL, GOOGLE, GITHUB
‚îÇ   ‚îú‚îÄ‚îÄ DeckType.java                # LANGUAGE, GENERAL
‚îÇ   ‚îú‚îÄ‚îÄ ImageStyle.java              # ANIME, PHOTOREALISM, CARTOON, FILME
‚îÇ   ‚îú‚îÄ‚îÄ Language.java                # INGLES_EUA, PORTUGUES_BRASIL, etc.
‚îÇ   ‚îú‚îÄ‚îÄ ReviewRating.java            # ERRADO, DIFICIL, BOM, FACIL
‚îÇ   ‚îú‚îÄ‚îÄ Role.java                    # USER, ADMIN
‚îÇ   ‚îî‚îÄ‚îÄ TextPromptStyle.java         # Templates de prompts
‚îÇ
‚îú‚îÄ‚îÄ payment/                         # M√≥dulo de Pagamentos
‚îÇ   ‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MercadoPagoClient.java   # Cliente HTTP Mercado Pago
‚îÇ   ‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreatePaymentPreferenceController.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WebhookController.java
‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Payment.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PaymentTransaction.java  # Hist√≥rico de transa√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PaymentTransactionRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ       ‚îú‚îÄ‚îÄ CreatePaymentPreferenceService.java
‚îÇ       ‚îî‚îÄ‚îÄ ProcessPaymentNotificationService.java
‚îÇ
‚îú‚îÄ‚îÄ repository/                      # Interfaces Spring Data JPA
‚îÇ   ‚îú‚îÄ‚îÄ DeckRepository.java
‚îÇ   ‚îú‚îÄ‚îÄ FlashCardRepository.java
‚îÇ   ‚îú‚îÄ‚îÄ ReviewRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ UserRepository.java
‚îÇ
‚îú‚îÄ‚îÄ service/                         # Camada de Neg√≥cio
‚îÇ   ‚îú‚îÄ‚îÄ AudioGenerationService.java  # Gemini TTS
‚îÇ   ‚îú‚îÄ‚îÄ AwsService.java              # S3 + CloudFront
‚îÇ   ‚îú‚îÄ‚îÄ CustomOAuth2UserService.java # OAuth2 Google/GitHub
‚îÇ   ‚îú‚îÄ‚îÄ CustomOidcUserService.java
‚îÇ   ‚îú‚îÄ‚îÄ DeckService.java             # L√≥gica de Decks
‚îÇ   ‚îú‚îÄ‚îÄ EmailService.java            # SMTP Gmail
‚îÇ   ‚îú‚îÄ‚îÄ FlashCardService.java        # L√≥gica de Flashcards
‚îÇ   ‚îú‚îÄ‚îÄ ImageGenerationService.java  # Gemini Imagen
‚îÇ   ‚îú‚îÄ‚îÄ JwtService.java              # Gera√ß√£o/Valida√ß√£o JWT
‚îÇ   ‚îú‚îÄ‚îÄ ReviewService.java           # Algoritmo de Repeti√ß√£o Espa√ßada
‚îÇ   ‚îú‚îÄ‚îÄ TextGenerationService.java   # Gemini Text
‚îÇ   ‚îî‚îÄ‚îÄ UserService.java
‚îÇ
‚îú‚îÄ‚îÄ util/                            # Classes Utilit√°rias
‚îÇ   ‚îî‚îÄ‚îÄ PromptTemplates.java
‚îÇ
‚îî‚îÄ‚îÄ SpacedRepetitionAiApplication.java  # Classe Main
```

### üìä Modelo de Dados (Entidades Principais)

```mermaid
erDiagram
    USER ||--o{ DECK : owns
    DECK ||--o{ FLASHCARD : contains
    FLASHCARD ||--o{ REVIEW : has
    USER ||--o{ PAYMENT_TRANSACTION : makes

    USER {
        Long id PK
        String name
        String email UK
        String password
        Role role
        int balance
        AuthProvider authProvider
        boolean isVerified
        String verificationToken
        LocalDateTime tokenExpirationDate
    }

    DECK {
        Long id PK
        Long user_id FK
        String name
        String description
        Language targetLanguage
        Language sourceLanguage
        boolean generateImage
        boolean generateAudio
        DeckType deckType
        ImageStyle imageStyle
        double easeFactor
        int totalReviewCount
        int totalReviewRate
    }

    FLASHCARD {
        Long id PK
        Long deck_id FK
        String front
        String back
        String imagePath
        String audioPath
        LocalDateTime createdDate
        LocalDateTime lastReview
        LocalDateTime nextReview
        int interval
        double easeFactor
        ReviewRating rating
    }

    REVIEW {
        Long id PK
        Long flashcard_id FK
        LocalDateTime reviewDate
        ReviewRating rating
    }

    PAYMENT_TRANSACTION {
        Long id PK
        Long user_id FK
        String mercadoPagoPaymentId
        String packageId
        int creditsPurchased
        BigDecimal amount
        PaymentStatus status
        String statusDetail
        LocalDateTime createdAt
    }
```

---

## üî¨ Testes

O projeto possui cobertura de testes unit√°rios e de integra√ß√£o.

### Executar Todos os Testes

```bash
mvn test
```

### Executar Teste Espec√≠fico

```bash
mvn test -Dtest=DeckServiceTest
```

### Configura√ß√£o de Testes

Os testes utilizam:
- **H2 Database** (banco em mem√≥ria)
- **Mockito** para mock de depend√™ncias
- Perfil de teste: `src/test/resources/application-teste.properties`

### Estrutura de Testes

```
src/test/java/com/spaced_repetition_ai/
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îî‚îÄ‚îÄ DeckRepositoryTest.java
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îî‚îÄ‚îÄ DeckServiceTest.java
‚îî‚îÄ‚îÄ SpacedRepetitionAiApplicationTests.java
```

---

## üê≥ Deployment com Docker

### Build da Imagem

```bash
docker build -t spaced-repetition-ai:latest .
```

### Executar com Docker Compose

```bash
docker-compose up -d
```

O `docker-compose.yml` configura:
- Aplica√ß√£o Spring Boot (porta 9090)
- PostgreSQL (opcional, se n√£o usar externo)
- Vari√°veis de ambiente via arquivo `.env`

### Exemplo de `.env`

```env
SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/spaced_repetition_db
SPRING_DATASOURCE_USERNAME=postgres
SPRING_DATASOURCE_PASSWORD=postgres
JWT_SECRET_KEY=your-jwt-secret-key
GEMINI_API_KEY=your-gemini-api-key
MERCADOPAGO_ACCESS_TOKEN=your-mercadopago-token
AWS_ACCESS_KEY=your-aws-access-key
AWS_SECRET_KEY=your-aws-secret-key
```

---

## ü§ù Como Contribuir

Contribui√ß√µes s√£o bem-vindas! Siga os passos abaixo:

### 1. Fork o Projeto

```bash
git clone https://github.com/seu-usuario/Spaced-Repetition-AI.git
cd Spaced-Repetition-AI
```

### 2. Crie uma Branch para sua Feature

```bash
git checkout -b feature/minha-nova-feature
```

### 3. Fa√ßa suas Altera√ß√µes e Commit

```bash
git add .
git commit -m "feat: adiciona nova funcionalidade X"
```

**Padr√£o de Commits (Conventional Commits):**
- `feat`: Nova funcionalidade
- `fix`: Corre√ß√£o de bug
- `docs`: Atualiza√ß√£o de documenta√ß√£o
- `refactor`: Refatora√ß√£o de c√≥digo
- `test`: Adi√ß√£o/corre√ß√£o de testes
- `chore`: Tarefas de manuten√ß√£o

### 4. Push para o GitHub

```bash
git push origin feature/minha-nova-feature
```

### 5. Abra um Pull Request

Descreva detalhadamente suas altera√ß√µes e o problema que elas resolvem.

### Diretrizes de C√≥digo

- Siga as conven√ß√µes de c√≥digo Java (Google Java Style Guide)
- Escreva testes para novas funcionalidades
- Mantenha a cobertura de testes acima de 80%
- Documente classes e m√©todos p√∫blicos com Javadoc
- Use Lombok para reduzir boilerplate


---

## üë®‚Äçüíª Autor

<div align="center">

### **Igor Lana**

Desenvolvedor Full Stack | Especialista em Java & Spring Boot

[![LinkedIn](https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white)](https://linkedin.com/in/igor-lana/)
[![GitHub](https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white)](https://github.com/IgorLana/)
[![Email](https://img.shields.io/badge/Email-D14836?style=for-the-badge&logo=gmail&logoColor=white)](mailto:igorlana1@outlook.com)

</div>

---

## üìû Suporte

Se voc√™ encontrar algum problema ou tiver d√∫vidas:

- üêõ Abra uma [Issue](https://github.com/IgorLana/Spaced-Repetition-AI/issues)
- üìß Entre em contato: igorlana1@outlook.com
- üí¨ Discuss√µes: [GitHub Discussions](https://github.com/IgorLana/Spaced-Repetition-AI/discussions)



---

<div align="center">

**Se este projeto foi √∫til para voc√™, considere dar uma ‚≠ê!**

Feito com ‚ù§Ô∏è por [Igor Lana](https://github.com/IgorLana)

</div>
